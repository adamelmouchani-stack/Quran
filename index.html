<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="icon" type="image/png" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%23eab308'/%3E%3Ctext x='50' y='70' font-size='60' text-anchor='middle' fill='white' font-family='Amiri'%3Eï·½%3C/text%3E%3C/svg%3E">

<title>Quran | Index + Lees-pagina</title>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = { darkMode: 'class' }
</script>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
  body { font-family: 'Poppins', sans-serif; }
  
  .header {
    background: white;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    padding: 12px 0;
  }
  
  .dark .header {
    background: #1f2937;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  }
  
  .welcome-message {
    background: linear-gradient(135deg, #fef9e7 0%, #ffffff 100%);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 20px;
  }
  
  .dark .welcome-message {
    background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
  }
  
  .arabic-text {
    font-family: 'Amiri', serif;
    font-size: clamp(1.6rem, 5vw, 2.2rem);
    direction: rtl;
  }
  
  .surah-card {
    background: white;
    border-radius: 15px;
    padding: 20px;
    cursor: pointer;
    transition: all 0.3s;
    border: 1px solid transparent;
  }
  
  .dark .surah-card {
    background: #1f2937;
  }
  
  .surah-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px -5px rgba(0,0,0,0.2);
    border-color: #eab308;
  }
  
  .last-read {
    border-left: 4px solid #eab308;
    background: rgba(234, 179, 8, 0.05);
  }
  
  .last-read-highlight {
    animation: highlightPulse 1.5s ease;
  }
  
  @keyframes highlightPulse {
    0% { background-color: rgba(234, 179, 8, 0); }
    50% { background-color: rgba(234, 179, 8, 0.3); }
    100% { background-color: rgba(234, 179, 8, 0); }
  }
  
  .last-read-badge {
    display: inline-block;
    background: #eab308;
    color: white;
    font-size: 0.7rem;
    padding: 2px 8px;
    border-radius: 12px;
    margin-left: 8px;
  }
  
  .loading-spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #f3f3f3;
    border-top: 4px solid #eab308;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 40px auto;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  .footer {
    background: white;
    border-top: 1px solid #e5e7eb;
    padding: 30px 0;
    margin-top: 50px;
  }
  
  .dark .footer {
    background: #1f2937;
    border-color: #374151;
  }
  
  .support-email {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 12px 25px;
    background: #eab308;
    color: #1e293b;
    border-radius: 50px;
    font-weight: bold;
    transition: all 0.3s;
  }
  
  .support-email:hover {
    background: #fbbf24;
    transform: scale(1.05);
    box-shadow: 0 10px 20px -5px rgba(234, 179, 8, 0.5);
  }
  
  .clear-btn {
    color: #6b7280;
    transition: all 0.2s;
    cursor: pointer;
  }
  
  .clear-btn:hover {
    color: #ef4444;
  }
  
  .search-container {
    margin-bottom: 24px;
  }
  
  .search-box {
    display: flex;
    align-items: center;
    background: white;
    border-radius: 50px;
    padding: 4px 4px 4px 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    border: 2px solid transparent;
    transition: all 0.3s;
  }
  
  .dark .search-box {
    background: #1f2937;
  }
  
  .search-box:focus-within {
    border-color: #eab308;
    box-shadow: 0 4px 15px rgba(234, 179, 8, 0.2);
  }
  
  .search-input {
    flex: 1;
    padding: 12px 0;
    background: transparent;
    border: none;
    outline: none;
    font-size: 1rem;
  }
  
  .dark .search-input {
    color: white;
  }
  
  .search-input::placeholder {
    color: #9ca3af;
  }
  
  .search-btn {
    background: #eab308;
    border: none;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .search-btn:hover {
    background: #fbbf24;
    transform: scale(1.05);
  }
  
  .search-results-info {
    text-align: center;
    margin: 10px 0;
    padding: 8px;
    background: rgba(234, 179, 8, 0.1);
    border-radius: 20px;
    font-size: 0.9rem;
  }
  
  .reset-search-btn {
    background: none;
    border: none;
    color: #eab308;
    cursor: pointer;
    font-weight: bold;
    margin-left: 10px;
  }
  
  .reset-search-btn:hover {
    text-decoration: underline;
  }
  
  .no-results {
    text-align: center;
    padding: 40px;
    color: #9ca3af;
    font-style: italic;
  }
  
  /* Last read card op main pagina */
  .last-read-card {
    background: linear-gradient(135deg, #eab308 0%, #fbbf24 100%);
    color: #1e293b;
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 20px;
    cursor: pointer;
    transition: all 0.3s;
  }
  
  .last-read-card:hover {
    transform: scale(1.02);
    box-shadow: 0 10px 25px -5px rgba(234, 179, 8, 0.5);
  }
  
  .dark .last-read-card {
    background: linear-gradient(135deg, #b45309 0%, #d97706 100%);
    color: white;
  }

  /* Voortgangsindicatie */
  .progress-pill {
    background: #e5e7eb;
    border-radius: 40px;
    padding: 0.3rem 1.2rem;
    font-size: 0.8rem;
    display: inline-block;
    margin-bottom: 1rem;
  }

  .dark .progress-pill {
    background: #374151;
  }

  /* ===== NIEUWE STYLE VOOR TAAL BALK ===== */
  .language-select {
    background-color: white;
    border: 1px solid #d1d5db;
    border-radius: 12px;  /* Mooi afgerond, niet helemaal rond */
    padding: 0.4rem 1.8rem 0.4rem 1rem;
    font-size: 0.9rem;
    color: #374151;
    cursor: pointer;
    outline: none;
    transition: all 0.2s;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
    background-position: right 0.5rem center;
    background-repeat: no-repeat;
    background-size: 1.2rem;
  }

  .dark .language-select {
    background-color: #374151;
    border-color: #4b5563;
    color: white;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
  }

  .language-select:hover {
    border-color: #eab308;
  }

  .language-select:focus {
    border-color: #eab308;
    box-shadow: 0 0 0 2px rgba(234, 179, 8, 0.2);
  }

  /* Theme knop ook wat ronder */
  .theme-btn {
    border-radius: 12px;  /* Zelfde radius als taal balk */
    width: 42px;
    height: 42px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f3f4f6;
    border: 1px solid #d1d5db;
    transition: all 0.2s;
  }

  .dark .theme-btn {
    background-color: #374151;
    border-color: #4b5563;
    color: white;
  }

  .theme-btn:hover {
    background-color: #eab308;
    border-color: #eab308;
    color: white;
  }
</style>
</head>

<body class="bg-gray-100 text-gray-900 dark:bg-gray-900 dark:text-gray-100">

<!-- ========== HEADER ========== -->
<header class="header">
  <div class="max-w-7xl mx-auto px-4">
    <div class="flex flex-wrap justify-between items-center gap-2">
      <h1 class="text-2xl font-bold" id="headerTitle">Quran</h1>
      
      <div class="flex gap-2 items-center">
        <!-- VERBETERDE TAAL BALK - mooi afgerond -->
        <select id="languageSelect" class="language-select">
          <option value="arabic">ðŸ‡¸ðŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
          <option value="nl" selected>ðŸ‡³ðŸ‡± Nederlands</option>
          <option value="en">ðŸ‡¬ðŸ‡§ English</option>
        </select>
        
        <!-- Theme knop ook aangepast -->
        <button id="themeBtn" class="theme-btn">
          <i class="fas fa-moon dark:hidden"></i>
          <i class="fas fa-sun hidden dark:inline"></i>
        </button>
      </div>
    </div>
  </div>
</header>

<main class="max-w-7xl mx-auto px-4 py-6">

  <!-- Welkomstbericht -->
  <div class="welcome-message">
    <div class="flex items-center gap-3">
      <i class="fas fa-book-open text-amber-500 text-3xl"></i>
      <div>
        <h2 class="text-xl font-bold" id="welcomeTitle">Welkom bij Quran</h2>
        <p class="text-gray-600 dark:text-gray-400" id="welcomeText">Klik op een soera om te beginnen met lezen</p>
      </div>
    </div>
  </div>

  <!-- ===== LAST READ CARD ===== -->
  <div id="lastReadCard" class="last-read-card hidden">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-3">
        <i class="fas fa-bookmark text-2xl"></i>
        <div>
          <div class="text-sm opacity-90" id="lastReadLabel">Laatst gelezen</div>
          <div class="font-bold text-lg" id="lastReadDisplay">
            <span id="lastReadSurahName"></span> - 
            <span id="lastReadVerseNumber"></span>
          </div>
        </div>
      </div>
      <div class="flex gap-2">
        <button id="jumpToLastReadBtn" class="bg-white text-amber-600 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-amber-100 transition">
          <i class="fas fa-arrow-right mr-1"></i> <span id="jumpBtnText">Ga verder</span>
        </button>
        <button id="clearLastReadBtn" class="bg-amber-600 text-white px-3 py-2 rounded-lg text-sm hover:bg-amber-700 transition">
          <i class="fas fa-trash-alt"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Zoekbalk -->
  <div class="search-container">
    <div class="search-box">
      <input type="text" id="searchInput" class="search-input" placeholder="Zoek soera (naam of nummer)...">
      <button id="searchBtn" class="search-btn">
        <i class="fas fa-search"></i>
      </button>
    </div>
    <div id="searchInfo" class="search-results-info hidden">
      <span id="searchResultsCount"></span>
      <button id="resetSearchBtn" class="reset-search-btn">
        <i class="fas fa-times"></i> Wissen
      </button>
    </div>
  </div>

  <!-- Voortgangsindicatie -->
  <div id="progressIndicator" class="progress-pill hidden">
    <i class="fas fa-list mr-2 text-amber-500"></i>
    <span id="progressText">Soera 0 van 114</span>
  </div>

  <!-- Loading spinner -->
  <div id="loadingSpinner" class="loading-spinner hidden"></div>

  <!-- Soera lijst -->
  <div id="surahList" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>

  <!-- Soera pagina -->
  <div id="surahPage" class="hidden">
    <button id="backBtn" class="mb-4 px-4 py-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-amber-500 transition-all">
      <i class="fas fa-arrow-left mr-1"></i> <span id="backText">Terug</span>
    </button>

    <div class="bg-gradient-to-r from-amber-50 to-yellow-50 dark:from-gray-800 dark:to-gray-800 rounded-2xl p-6 mb-6">
      <h2 id="surahTitle" class="text-3xl font-bold mb-1"></h2>
      <p id="surahInfo" class="text-gray-600 dark:text-gray-400 mb-2"></p>
      
      <div class="flex items-center gap-2 mt-2" id="lastReadBadgeContainer">
        <div id="lastReadBadge" class="hidden">
          <span class="inline-flex items-center gap-1 bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200 text-xs px-2 py-1 rounded-full">
            <i class="fas fa-bookmark text-amber-500"></i>
            <span id="lastReadBadgeText">Laatst gelezen: vers </span>
          </span>
        </div>
      </div>
    </div>

    <div class="bg-white dark:bg-gray-800 rounded-xl p-4 mb-6">
      <audio id="surahAudio" controls class="w-full"></audio>
    </div>

    <div id="surahText" class="space-y-4"></div>
  </div>

</main>

<!-- ========== CONFIRMATIE MODAL ========== -->
<div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-sm mx-4">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-bold text-amber-500" id="modalTitle">Bevestigen</h3>
      <button id="closeConfirmModal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <p class="mb-6 text-center" id="modalText">Weet je zeker dat je de last read marker wilt verwijderen?</p>
    <button id="confirmClearBtn" class="w-full bg-red-500 text-white py-3 rounded-lg font-semibold hover:bg-red-600 transition">
      <i class="fas fa-trash-alt mr-2"></i> <span id="confirmBtnText">Ja, verwijder</span>
    </button>
  </div>
</div>

<!-- ========== FOOTER ========== -->
<footer class="footer">
  <div class="max-w-7xl mx-auto px-4 text-center">
    <h3 class="text-lg font-semibold mb-4" id="supportTitle">Heb je vragen of hulp nodig?</h3>
    
    <a href="mailto:elmouchania@hotmail.com" class="support-email">
      <i class="fas fa-envelope"></i>
      <span>elmouchania@hotmail.com</span>
    </a>
    
    <div class="mt-6 text-sm text-gray-500 dark:text-gray-400">
      <p>Â© 2026 Quran. Alle rechten voorbehouden.</p>
      <p class="mt-1" id="responseTime">Antwoord binnen 24 uur op werkdagen</p>
    </div>
  </div>
</footer>

<script>
// ========== STATE ==========
let currentLanguage = 'nl';
let currentSurahId = null;
let allSurahsData = [];
let searchActive = false;

// ========== DOM ELEMENTEN ==========
const searchInput = document.getElementById('searchInput');
const searchBtn = document.getElementById('searchBtn');
const searchInfo = document.getElementById('searchInfo');
const searchResultsCount = document.getElementById('searchResultsCount');
const resetSearchBtn = document.getElementById('resetSearchBtn');

// Last read elements
const lastReadCard = document.getElementById('lastReadCard');
const lastReadSurahName = document.getElementById('lastReadSurahName');
const lastReadVerseNumber = document.getElementById('lastReadVerseNumber');
const jumpToLastReadBtn = document.getElementById('jumpToLastReadBtn');
const clearLastReadBtn = document.getElementById('clearLastReadBtn');
const lastReadBadge = document.getElementById('lastReadBadge');
const lastReadBadgeText = document.getElementById('lastReadBadgeText');
const lastReadLabel = document.getElementById('lastReadLabel');
const jumpBtnText = document.getElementById('jumpBtnText');

// Modal elements
const confirmModal = document.getElementById('confirmModal');
const closeConfirmModal = document.getElementById('closeConfirmModal');
const confirmClearBtn = document.getElementById('confirmClearBtn');
const modalTitle = document.getElementById('modalTitle');
const modalText = document.getElementById('modalText');
const confirmBtnText = document.getElementById('confirmBtnText');

// Voortgangsindicatie
const progressIndicator = document.getElementById('progressIndicator');
const progressText = document.getElementById('progressText');

// ========== TALEN ==========
const translations = {
  arabic: {
    headerTitle: "Ø§Ù„Ù‚Ø±Ø¢Ù†",
    back: "Ø±Ø¬ÙˆØ¹",
    verses: "Ø¢ÙŠØ§Øª",
    welcomeTitle: "Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†",
    welcomeText: "Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø³ÙˆØ±Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©",
    supportTitle: "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø£Ø³Ø¦Ù„Ø© Ø£Ùˆ ØªØ­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø©ØŸ",
    responseTime: "Ø§Ù„Ø±Ø¯ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø© ÙÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„",
    searchPlaceholder: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø³ÙˆØ±Ø©...",
    searchResults: "Ù†ØªØ§Ø¦Ø¬",
    resetSearch: "Ù…Ø³Ø­",
    lastReadLabel: "Ø¢Ø®Ø± Ù‚Ø±Ø§Ø¡Ø©",
    jumpBtn: "Ø§Ø³ØªÙ…Ø±",
    lastReadBadge: "Ø¢Ø®Ø± Ù‚Ø±Ø§Ø¡Ø©: Ø¢ÙŠØ©",
    modalTitle: "ØªØ£ÙƒÙŠØ¯",
    modalText: "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¢Ø®Ø± Ù‚Ø±Ø§Ø¡Ø©ØŸ",
    confirmBtn: "Ù†Ø¹Ù…ØŒ Ù…Ø³Ø­"
  },
  nl: {
    headerTitle: "Quran",
    back: "Terug",
    verses: "verzen",
    welcomeTitle: "Welkom bij Quran",
    welcomeText: "Klik op een soera om te beginnen met lezen",
    supportTitle: "Heb je vragen of hulp nodig?",
    responseTime: "Antwoord binnen 24 uur op werkdagen",
    searchPlaceholder: "Zoek soera (naam of nummer)...",
    searchResults: "resultaten gevonden",
    resetSearch: "Wissen",
    lastReadLabel: "Laatst gelezen",
    jumpBtn: "Ga verder",
    lastReadBadge: "Laatst gelezen: vers",
    modalTitle: "Bevestigen",
    modalText: "Weet je zeker dat je de last read marker wilt verwijderen?",
    confirmBtn: "Ja, verwijder"
  },
  en: {
    headerTitle: "Quran",
    back: "Back",
    verses: "verses",
    welcomeTitle: "Welcome to Quran",
    welcomeText: "Click on a surah to start reading",
    supportTitle: "Do you have questions or need help?",
    responseTime: "Reply within 24 hours on weekdays",
    searchPlaceholder: "Search surah (name or number)...",
    searchResults: "results found",
    resetSearch: "Clear",
    lastReadLabel: "Last read",
    jumpBtn: "Continue",
    lastReadBadge: "Last read: verse",
    modalTitle: "Confirm",
    modalText: "Are you sure you want to clear last read?",
    confirmBtn: "Yes, clear"
  }
};

// ========== SOERA NAMEN ==========
const latinSuraNames = [
  "Al-Fatiha", "Al-Baqara", "Aal-E-Imran", "An-Nisa", "Al-Ma'idah",
  "Al-An'am", "Al-A'raf", "Al-Anfal", "At-Tawbah", "Yunus",
  "Hud", "Yusuf", "Ar-Ra'd", "Ibrahim", "Al-Hijr",
  "An-Nahl", "Al-Isra", "Al-Kahf", "Maryam", "Ta-Ha",
  "Al-Anbiya", "Al-Hajj", "Al-Mu'minun", "An-Nur", "Al-Furqan",
  "Ash-Shu'ara", "An-Naml", "Al-Qasas", "Al-Ankabut", "Ar-Rum",
  "Luqman", "As-Sajda", "Al-Ahzab", "Saba", "Fatir",
  "Ya-Sin", "As-Saffat", "Sad", "Az-Zumar", "Ghafir",
  "Fussilat", "Ash-Shura", "Az-Zukhruf", "Ad-Dukhan", "Al-Jathiya",
  "Al-Ahqaf", "Muhammad", "Al-Fath", "Al-Hujurat", "Qaf",
  "Adh-Dhariyat", "At-Tur", "An-Najm", "Al-Qamar", "Ar-Rahman",
  "Al-Waqia", "Al-Hadid", "Al-Mujadila", "Al-Hashr", "Al-Mumtahina",
  "As-Saff", "Al-Jumu'a", "Al-Munafiqun", "At-Taghabun", "At-Talaq",
  "At-Tahrim", "Al-Mulk", "Al-Qalam", "Al-Haqqa", "Al-Ma'arij",
  "Nuh", "Al-Jinn", "Al-Muzzammil", "Al-Muddaththir", "Al-Qiyama",
  "Al-Insan", "Al-Mursalat", "An-Naba", "An-Nazi'at", "Abasa",
  "At-Takwir", "Al-Infitar", "Al-Mutaffifin", "Al-Inshiqaq", "Al-Buruj",
  "At-Tariq", "Al-A'la", "Al-Ghashiya", "Al-Fajr", "Al-Balad",
  "Ash-Shams", "Al-Lail", "Ad-Duha", "Ash-Sharh", "At-Tin",
  "Al-Alaq", "Al-Qadr", "Al-Bayyina", "Az-Zalzala", "Al-Adiyat",
  "Al-Qaria", "At-Takathur", "Al-Asr", "Al-Humaza", "Al-Fil",
  "Quraish", "Al-Ma'un", "Al-Kawthar", "Al-Kafirun", "An-Nasr",
  "Al-Masad", "Al-Ikhlas", "Al-Falaq", "An-Nas"
];

const arabicSuraNames = [
  "Ø§Ù„ÙØ§ØªØ­Ø©", "Ø§Ù„Ø¨Ù‚Ø±Ø©", "Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†", "Ø§Ù„Ù†Ø³Ø§Ø¡", "Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©",
  "Ø§Ù„Ø£Ù†Ø¹Ø§Ù…", "Ø§Ù„Ø£Ø¹Ø±Ø§Ù", "Ø§Ù„Ø£Ù†ÙØ§Ù„", "Ø§Ù„ØªÙˆØ¨Ø©", "ÙŠÙˆÙ†Ø³",
  "Ù‡ÙˆØ¯", "ÙŠÙˆØ³Ù", "Ø§Ù„Ø±Ø¹Ø¯", "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…", "Ø§Ù„Ø­Ø¬Ø±",
  "Ø§Ù„Ù†Ø­Ù„", "Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡", "Ø§Ù„ÙƒÙ‡Ù", "Ù…Ø±ÙŠÙ…", "Ø·Ù‡",
  "Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡", "Ø§Ù„Ø­Ø¬", "Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†", "Ø§Ù„Ù†ÙˆØ±", "Ø§Ù„ÙØ±Ù‚Ø§Ù†",
  "Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡", "Ø§Ù„Ù†Ù…Ù„", "Ø§Ù„Ù‚ØµØµ", "Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª", "Ø§Ù„Ø±ÙˆÙ…",
  "Ù„Ù‚Ù…Ø§Ù†", "Ø§Ù„Ø³Ø¬Ø¯Ø©", "Ø§Ù„Ø£Ø­Ø²Ø§Ø¨", "Ø³Ø¨Ø¥", "ÙØ§Ø·Ø±",
  "ÙŠØ³", "Ø§Ù„ØµØ§ÙØ§Øª", "Øµ", "Ø§Ù„Ø²Ù…Ø±", "ØºØ§ÙØ±",
  "ÙØµÙ„Øª", "Ø§Ù„Ø´ÙˆØ±Ù‰", "Ø§Ù„Ø²Ø®Ø±Ù", "Ø§Ù„Ø¯Ø®Ø§Ù†", "Ø§Ù„Ø¬Ø§Ø«ÙŠØ©",
  "Ø§Ù„Ø£Ø­Ù‚Ø§Ù", "Ù…Ø­Ù…Ø¯", "Ø§Ù„ÙØªØ­", "Ø§Ù„Ø­Ø¬Ø±Ø§Øª", "Ù‚",
  "Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª", "Ø§Ù„Ø·ÙˆØ±", "Ø§Ù„Ù†Ø¬Ù…", "Ø§Ù„Ù‚Ù…Ø±", "Ø§Ù„Ø±Ø­Ù…Ù†",
  "Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©", "Ø§Ù„Ø­Ø¯ÙŠØ¯", "Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©", "Ø§Ù„Ø­Ø´Ø±", "Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©",
  "Ø§Ù„ØµÙ", "Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†", "Ø§Ù„ØªØºØ§Ø¨Ù†", "Ø§Ù„Ø·Ù„Ø§Ù‚",
  "Ø§Ù„ØªØ­Ø±ÙŠÙ…", "Ø§Ù„Ù…Ù„Ùƒ", "Ø§Ù„Ù‚Ù„Ù…", "Ø§Ù„Ø­Ø§Ù‚Ø©", "Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬",
  "Ù†ÙˆØ­", "Ø§Ù„Ø¬Ù†", "Ø§Ù„Ù…Ø²Ù…Ù„", "Ø§Ù„Ù…Ø¯Ø«Ø±", "Ø§Ù„Ù‚ÙŠØ§Ù…Ø©",
  "Ø§Ù„Ø¥Ù†Ø³Ø§Ù†", "Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª", "Ø§Ù„Ù†Ø¨Ø¥", "Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª", "Ø¹Ø¨Ø³",
  "Ø§Ù„ØªÙƒÙˆÙŠØ±", "Ø§Ù„Ø¥Ù†ÙØ·Ø§Ø±", "Ø§Ù„Ù…Ø·ÙÙÙŠÙ†", "Ø§Ù„Ø¥Ù†Ø´Ù‚Ø§Ù‚", "Ø§Ù„Ø¨Ø±ÙˆØ¬",
  "Ø§Ù„Ø·Ø§Ø±Ù‚", "Ø§Ù„Ø£Ø¹Ù„Ù‰", "Ø§Ù„ØºØ§Ø´ÙŠØ©", "Ø§Ù„ÙØ¬Ø±", "Ø§Ù„Ø¨Ù„Ø¯",
  "Ø§Ù„Ø´Ù…Ø³", "Ø§Ù„Ù„ÙŠÙ„", "Ø§Ù„Ø¶Ø­Ù‰", "Ø§Ù„Ø´Ø±Ø­", "Ø§Ù„ØªÙŠÙ†",
  "Ø§Ù„Ø¹Ù„Ù‚", "Ø§Ù„Ù‚Ø¯Ø±", "Ø§Ù„Ø¨ÙŠÙ†Ø©", "Ø§Ù„Ø²Ù„Ø²Ù„Ø©", "Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª",
  "Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©", "Ø§Ù„ØªÙƒØ§Ø«Ø±", "Ø§Ù„Ø¹ØµØ±", "Ø§Ù„Ù‡Ù…Ø²Ø©", "Ø§Ù„ÙÙŠÙ„",
  "Ù‚Ø±ÙŠØ´", "Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†", "Ø§Ù„ÙƒÙˆØ«Ø±", "Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†", "Ø§Ù„Ù†ØµØ±",
  "Ø§Ù„Ù…Ø³Ø¯", "Ø§Ù„Ø¥Ø®Ù„Ø§Øµ", "Ø§Ù„ÙÙ„Ù‚", "Ø§Ù„Ù†Ø§Ø³"
];

// ========== LAST READ FUNCTIES ==========
function saveLastRead(surahId, verseNumber) {
  try {
    const lastRead = {
      surahId: surahId,
      verseNumber: verseNumber,
      timestamp: new Date().toISOString()
    };
    localStorage.setItem('lastRead', JSON.stringify(lastRead));
    updateLastReadUI();
  } catch (error) {
    console.error('Fout bij opslaan last read:', error);
  }
}

function getLastRead() {
  try {
    const lastReadJson = localStorage.getItem('lastRead');
    if (!lastReadJson) return null;
    return JSON.parse(lastReadJson);
  } catch (error) {
    console.error('Fout bij ophalen last read:', error);
    return null;
  }
}

function clearLastRead() {
  localStorage.removeItem('lastRead');
  updateLastReadUI();
  if (currentSurahId) {
    openSurah(currentSurahId);
  }
}

function updateLastReadUI() {
  const lastRead = getLastRead();
  
  if (lastRead && lastReadCard) {
    const surahIndex = lastRead.surahId - 1;
    const surahName = currentLanguage === 'arabic' 
      ? (arabicSuraNames[surahIndex] || `Ø³ÙˆØ±Ø© ${lastRead.surahId}`)
      : (latinSuraNames[surahIndex] || `Surah ${lastRead.surahId}`);
    
    lastReadSurahName.textContent = surahName;
    lastReadVerseNumber.textContent = `${lastRead.verseNumber}`;
    lastReadCard.classList.remove('hidden');
    
    lastReadLabel.textContent = translations[currentLanguage].lastReadLabel;
    jumpBtnText.textContent = translations[currentLanguage].jumpBtn;
  } else if (lastReadCard) {
    lastReadCard.classList.add('hidden');
  }
}

function jumpToLastRead() {
  const lastRead = getLastRead();
  if (!lastRead) return;
  openSurah(lastRead.surahId);
}

// ========== UPDATE UI LANGUAGE ==========
function updateUILanguage() {
  document.getElementById('headerTitle').textContent = translations[currentLanguage].headerTitle;
  document.getElementById('backText').textContent = translations[currentLanguage].back;
  document.getElementById('welcomeTitle').textContent = translations[currentLanguage].welcomeTitle;
  document.getElementById('welcomeText').textContent = translations[currentLanguage].welcomeText;
  document.getElementById('supportTitle').textContent = translations[currentLanguage].supportTitle;
  document.getElementById('responseTime').textContent = translations[currentLanguage].responseTime;
  
  searchInput.placeholder = translations[currentLanguage].searchPlaceholder;
  
  // Modal teksten
  modalTitle.textContent = translations[currentLanguage].modalTitle;
  modalText.textContent = translations[currentLanguage].modalText;
  confirmBtnText.textContent = translations[currentLanguage].confirmBtn;
  
  updateLastReadUI();
}

// ========== FILTER SOERA'S ==========
function filterSurahs(searchTerm) {
  if (!searchTerm.trim()) return allSurahsData;
  
  const term = searchTerm.toLowerCase().trim();
  
  return allSurahsData.filter(surah => {
    const index = surah.number - 1;
    const latinName = latinSuraNames[index] || surah.englishName;
    const arabicName = arabicSuraNames[index] || surah.name;
    
    return surah.number.toString() === term ||
           latinName.toLowerCase().includes(term) ||
           arabicName.includes(term);
  });
}

// ========== DISPLAY SOERA'S ==========
function displaySurahs(surahsToShow) {
  const surahList = document.getElementById('surahList');
  
  if (!surahsToShow || surahsToShow.length === 0) {
    surahList.innerHTML = '<div class="col-span-full no-results"><i class="fas fa-search mr-2"></i>Geen soera\'s gevonden</div>';
    return;
  }
  
  surahList.innerHTML = '';
  
  // Update voortgang
  progressIndicator.classList.remove('hidden');
  const totalSurahs = allSurahsData.length;
  const currentCount = surahsToShow.length;
  
  if (searchActive) {
    progressText.textContent = `${currentCount} van ${totalSurahs} getoond`;
  } else {
    progressText.textContent = `Soera ${currentSurahId || '0'} van ${totalSurahs}`;
  }
  
  surahsToShow.forEach(surah => {
    const index = surah.number - 1;
    const card = document.createElement("div");
    card.className = "surah-card";

    let title = '';
    
    if (currentLanguage === 'arabic') {
      title = `<div class="arabic-text text-2xl mb-2">${arabicSuraNames[index] || surah.name}</div>`;
    } else {
      title = `<h3 class="font-bold text-lg">${surah.number}. ${latinSuraNames[index] || surah.englishName}</h3>`;
    }

    card.innerHTML = `
      ${title}
      <div class="mt-2 text-sm text-gray-500">${surah.numberOfAyahs} ${translations[currentLanguage].verses}</div>
      ${currentLanguage !== 'arabic' ? `<div class="arabic-text text-right text-sm mt-2">${arabicSuraNames[index] || surah.name}</div>` : ''}
    `;

    card.onclick = () => openSurah(surah.number);
    surahList.appendChild(card);
  });
}

// ========== ZOEKFUNCTIE ==========
function performSearch() {
  const searchTerm = searchInput.value;
  
  if (!searchTerm.trim()) {
    searchActive = false;
    searchInfo.classList.add('hidden');
    displaySurahs(allSurahsData);
    return;
  }
  
  const filteredSurahs = filterSurahs(searchTerm);
  searchActive = true;
  
  searchResultsCount.textContent = `${filteredSurahs.length} ${translations[currentLanguage].searchResults}`;
  searchInfo.classList.remove('hidden');
  
  displaySurahs(filteredSurahs);
}

function resetSearch() {
  searchInput.value = '';
  searchActive = false;
  searchInfo.classList.add('hidden');
  displaySurahs(allSurahsData);
}

// ========== LAAD SOERA LIJST ==========
async function loadSurahList() {
  const surahList = document.getElementById('surahList');
  const loadingSpinner = document.getElementById('loadingSpinner');
  
  loadingSpinner.classList.remove('hidden');
  surahList.innerHTML = '';
  
  try {
    const response = await fetch("https://api.alquran.cloud/v1/surah");
    const data = await response.json();
    allSurahsData = data.data;
    displaySurahs(allSurahsData);
  } catch (error) {
    surahList.innerHTML = '<div class="col-span-full text-center text-red-500">Fout bij laden</div>';
  }
  
  loadingSpinner.classList.add('hidden');
}

// ========== OPEN SURAH ==========
async function openSurah(id) {
  currentSurahId = id;
  
  document.getElementById('surahList').classList.add('hidden');
  document.getElementById('surahPage').classList.remove('hidden');
  
  // Update voortgang
  progressText.textContent = `Soera ${id} van 114`;
  
  const loadingSpinner = document.getElementById('loadingSpinner');
  loadingSpinner.classList.remove('hidden');
  
  try {
    const response = await fetch(`https://api.alquran.cloud/v1/surah/${id}`);
    const data = await response.json();
    const s = data.data;
    const index = s.number - 1;

    let title = '';
    if (currentLanguage === 'arabic') {
      title = `${s.number}. ${arabicSuraNames[index] || s.name}`;
    } else {
      title = `${s.number}. ${latinSuraNames[index] || s.englishName}`;
    }
    
    document.getElementById('surahTitle').textContent = title;
    document.getElementById('surahInfo').textContent = `${s.numberOfAyahs} ${translations[currentLanguage].verses}`;
    document.getElementById('surahAudio').src = `https://cdn.islamic.network/quran/audio-surah/128/ar.alafasy/${id}.mp3`;

    const surahText = document.getElementById('surahText');
    surahText.innerHTML = '';

    const lastRead = getLastRead();

    s.ayahs.forEach(a => {
      const d = document.createElement('div');
      d.className = "verse-container bg-white dark:bg-gray-800 rounded-lg p-4 cursor-pointer hover:border-amber-500 border border-transparent transition-all";
      
      const isLastRead = lastRead && lastRead.surahId === id && lastRead.verseNumber === a.numberInSurah;
      
      if (isLastRead) {
        d.classList.add('last-read');
      }

      d.innerHTML = `
        <div class="arabic-text">${a.text}</div>
        <div class="text-xs text-gray-500 mt-2">${currentLanguage === 'arabic' ? 'Ø¢ÙŠØ©' : 'Vers'} ${a.numberInSurah}</div>
      `;

      d.onclick = () => {
        const verseNumber = a.numberInSurah;
        const currentLastRead = getLastRead();
        
        if (currentLastRead && currentLastRead.surahId === id && currentLastRead.verseNumber === verseNumber) {
          clearLastRead();
        } else {
          saveLastRead(id, verseNumber);
        }
        
        openSurah(id);
      };

      surahText.appendChild(d);
    });

    if (lastRead && lastRead.surahId === id) {
      lastReadBadge.classList.remove('hidden');
      lastReadBadgeText.textContent = `${translations[currentLanguage].lastReadBadge} ${lastRead.verseNumber}`;
    } else {
      lastReadBadge.classList.add('hidden');
    }

    if (lastRead && lastRead.surahId === id) {
      setTimeout(() => {
        const verseElements = document.querySelectorAll('.verse-container');
        verseElements.forEach((el, index) => {
          if (index + 1 === lastRead.verseNumber) {
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            el.classList.add('last-read-highlight');
            setTimeout(() => el.classList.remove('last-read-highlight'), 2000);
          }
        });
      }, 500);
    }
    
  } catch (error) {
    document.getElementById('surahText').innerHTML = '<div class="text-red-500">Fout bij laden</div>';
  }
  
  loadingSpinner.classList.add('hidden');
}

// ========== EVENT LISTENERS ==========
document.getElementById('backBtn').addEventListener('click', () => {
  document.getElementById('surahPage').classList.add('hidden');
  document.getElementById('surahList').classList.remove('hidden');
  currentSurahId = null;
  updateLastReadUI();
  
  if (searchActive) {
    resetSearch();
  } else {
    displaySurahs(allSurahsData);
  }
});

clearLastReadBtn?.addEventListener('click', () => {
  confirmModal.classList.remove('hidden');
});

closeConfirmModal?.addEventListener('click', () => {
  confirmModal.classList.add('hidden');
});

confirmClearBtn?.addEventListener('click', () => {
  clearLastRead();
  confirmModal.classList.add('hidden');
});

window.addEventListener('click', (e) => {
  if (e.target === confirmModal) {
    confirmModal.classList.add('hidden');
  }
});

document.getElementById('themeBtn').addEventListener('click', () => {
  document.documentElement.classList.toggle('dark');
});

searchInput.addEventListener('input', performSearch);
searchBtn.addEventListener('click', performSearch);
resetSearchBtn.addEventListener('click', resetSearch);

searchInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter') {
    performSearch();
  }
});

jumpToLastReadBtn?.addEventListener('click', jumpToLastRead);

document.getElementById('languageSelect').addEventListener('change', (e) => {
  currentLanguage = e.target.value;
  updateUILanguage();
  
  if (currentSurahId) {
    openSurah(currentSurahId);
  } else {
    if (searchActive && searchInput.value.trim()) {
      performSearch();
    } else {
      displaySurahs(allSurahsData);
    }
  }
});

// ========== INIT ==========
updateUILanguage();
loadSurahList();
updateLastReadUI();
</script>

</body>
</html>
