<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quran Reader - Alleen Transliteratie</title>

<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = { darkMode: 'class' }
</script>

<link href="https://fonts.googleapis.com/css2?family=Amiri&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
  body { font-family: Poppins, sans-serif; }
  
  /* Arabische tekst */
  .arabic-text {
    font-family: Amiri, serif;
    font-size: clamp(1.6rem, 5vw, 2.2rem);
    direction: rtl;
  }
  
  /* Transliteratie tekst - ALLEEN UITSPRAAK */
  .transliteration-text {
    font-family: Poppins, sans-serif;
    font-size: clamp(1.3rem, 4vw, 1.8rem);
    direction: ltr;
    line-height: 1.8;
    color: #1e293b;
    font-weight: 400;
    letter-spacing: 0.2px;
  }
  
  .dark .transliteration-text {
    color: #e2e8f0;
  }
  
  .last-read {
    background-color: rgba(253, 224, 71, 0.3);
    border-left: 4px solid #facc15;
    padding-left: 10px;
  }
  
  .verse-container {
    padding: 1rem;
    border-radius: 0.5rem;
    cursor: pointer;
    transition: background-color 0.2s;
    margin-bottom: 0.5rem;
  }
  
  .verse-container:hover {
    background-color: rgba(0,0,0,0.02);
  }
  
  .dark .verse-container:hover {
    background-color: rgba(255,255,255,0.02);
  }
  
  .verse-number {
    font-size: 0.8rem;
    color: #6b7280;
    margin-top: 0.25rem;
  }
  
  /* Soera kaart styling */
  .surah-card {
    transition: all 0.2s;
    border: 1px solid transparent;
  }
  
  .surah-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
    border-color: #eab308;
  }
  
  .arabic-surah-name {
    font-family: Amiri, serif;
    font-size: 1.2rem;
    direction: rtl;
    margin-top: 0.5rem;
    color: #4b5563;
  }
  
  .dark .arabic-surah-name {
    color: #9ca3af;
  }
</style>
</head>

<body class="bg-gray-100 text-gray-900 dark:bg-gray-900 dark:text-gray-100 min-h-screen flex flex-col">

<header class="bg-white dark:bg-gray-800 shadow p-4 flex flex-wrap justify-between items-center gap-2">
  <h1 class="text-2xl font-bold" id="headerTitle">Quran</h1>
  <div class="flex gap-2">
    <select id="languageSelect" class="px-2 py-1 border rounded text-sm bg-white dark:bg-gray-700 dark:text-white">
      <option value="arabic">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
      <option value="nl">üá≥üá± Nederlands</option>
      <option value="en">üá¨üáß English</option>
    </select>
    <button id="themeBtn" class="px-3 py-1 border rounded">üåô / ‚òÄÔ∏è</button>
  </div>
</header>

<main class="flex-grow p-4 max-w-4xl mx-auto w-full">

  <div id="surahList"
       class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
  </div>

  <div id="surahPage" class="hidden">

    <button id="backBtn"
      class="mb-4 px-4 py-2 rounded bg-gray-200 text-black dark:bg-gray-700 dark:text-white">
      ‚Üê <span id="backText">Terug</span>
    </button>

    <h2 id="surahTitle" class="text-3xl font-bold mb-1"></h2>
    <p id="surahInfo" class="text-gray-600 dark:text-gray-400 mb-2"></p>

    <!-- LAST READ INFO -->
    <p id="lastReadInfo" class="mb-4 text-sm text-yellow-600 dark:text-yellow-400"></p>

    <audio id="surahAudio" controls class="w-full mb-6"></audio>

    <div id="surahText" class="space-y-4"></div>
  </div>

</main>

<footer class="bg-white dark:bg-gray-800 border-t dark:border-gray-700 p-4 text-center text-sm text-gray-600 dark:text-gray-400">
  <span id="supportText">Steun</span>:
  <a href="mailto:elmouchania@hotmail.com"
     class="underline text-black dark:text-white">
    elmouchania@hotmail.com
  </a>
</footer>

<script>
// ========== TALEN ==========
const translations = {
  arabic: {
    headerTitle: "ÿßŸÑŸÇÿ±ÿ¢ŸÜ",
    back: "ÿ±ÿ¨Ÿàÿπ",
    support: "ÿØÿπŸÖ",
    lastRead: "ÿ¢ÿÆÿ± ŸÇÿ±ÿßÿ°ÿ©: ÿ¢Ÿäÿ©",
    verses: "ÿ¢Ÿäÿßÿ™",
    loading: "ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...",
    error: "ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ",
    verse: "ÿ¢Ÿäÿ©",
    mode: "arabic"
  },
  nl: {
    headerTitle: "Quran",
    back: "Terug",
    support: "Steun",
    lastRead: "Laatst gelezen: vers",
    verses: "verzen",
    loading: "Laden...",
    error: "Laden mislukt",
    verse: "vers",
    mode: "transliteration"
  },
  en: {
    headerTitle: "Quran",
    back: "Back",
    support: "Support",
    lastRead: "Last read: verse",
    verses: "verses",
    loading: "Loading...",
    error: "Failed to load",
    verse: "verse",
    mode: "transliteration"
  }
};

// Soera namen in Latijnse letters
const latinSuraNames = [
  "Al-Fatiha", "Al-Baqara", "Aal-E-Imran", "An-Nisa", "Al-Ma'idah",
  "Al-An'am", "Al-A'raf", "Al-Anfal", "At-Tawbah", "Yunus",
  "Hud", "Yusuf", "Ar-Ra'd", "Ibrahim", "Al-Hijr",
  "An-Nahl", "Al-Isra", "Al-Kahf", "Maryam", "Ta-Ha",
  "Al-Anbiya", "Al-Hajj", "Al-Mu'minun", "An-Nur", "Al-Furqan",
  "Ash-Shu'ara", "An-Naml", "Al-Qasas", "Al-Ankabut", "Ar-Rum",
  "Luqman", "As-Sajda", "Al-Ahzab", "Saba", "Fatir",
  "Ya-Sin", "As-Saffat", "Sad", "Az-Zumar", "Ghafir",
  "Fussilat", "Ash-Shura", "Az-Zukhruf", "Ad-Dukhan", "Al-Jathiya",
  "Al-Ahqaf", "Muhammad", "Al-Fath", "Al-Hujurat", "Qaf",
  "Adh-Dhariyat", "At-Tur", "An-Najm", "Al-Qamar", "Ar-Rahman",
  "Al-Waqia", "Al-Hadid", "Al-Mujadila", "Al-Hashr", "Al-Mumtahina",
  "As-Saff", "Al-Jumu'a", "Al-Munafiqun", "At-Taghabun", "At-Talaq",
  "At-Tahrim", "Al-Mulk", "Al-Qalam", "Al-Haqqa", "Al-Ma'arij",
  "Nuh", "Al-Jinn", "Al-Muzzammil", "Al-Muddaththir", "Al-Qiyama",
  "Al-Insan", "Al-Mursalat", "An-Naba", "An-Nazi'at", "Abasa",
  "At-Takwir", "Al-Infitar", "Al-Mutaffifin", "Al-Inshiqaq", "Al-Buruj",
  "At-Tariq", "Al-A'la", "Al-Ghashiya", "Al-Fajr", "Al-Balad",
  "Ash-Shams", "Al-Lail", "Ad-Duha", "Ash-Sharh", "At-Tin",
  "Al-Alaq", "Al-Qadr", "Al-Bayyina", "Az-Zalzala", "Al-Adiyat",
  "Al-Qaria", "At-Takathur", "Al-Asr", "Al-Humaza", "Al-Fil",
  "Quraish", "Al-Ma'un", "Al-Kawthar", "Al-Kafirun", "An-Nasr",
  "Al-Masad", "Al-Ikhlas", "Al-Falaq", "An-Nas"
];

// Soera namen in Arabisch
const arabicSuraNames = [
  "ÿßŸÑŸÅÿßÿ™ÿ≠ÿ©", "ÿßŸÑÿ®ŸÇÿ±ÿ©", "ÿ¢ŸÑ ÿπŸÖÿ±ÿßŸÜ", "ÿßŸÑŸÜÿ≥ÿßÿ°", "ÿßŸÑŸÖÿßÿ¶ÿØÿ©",
  "ÿßŸÑÿ£ŸÜÿπÿßŸÖ", "ÿßŸÑÿ£ÿπÿ±ÿßŸÅ", "ÿßŸÑÿ£ŸÜŸÅÿßŸÑ", "ÿßŸÑÿ™Ÿàÿ®ÿ©", "ŸäŸàŸÜÿ≥",
  "ŸáŸàÿØ", "ŸäŸàÿ≥ŸÅ", "ÿßŸÑÿ±ÿπÿØ", "ÿ•ÿ®ÿ±ÿßŸáŸäŸÖ", "ÿßŸÑÿ≠ÿ¨ÿ±",
  "ÿßŸÑŸÜÿ≠ŸÑ", "ÿßŸÑÿ•ÿ≥ÿ±ÿßÿ°", "ÿßŸÑŸÉŸáŸÅ", "ŸÖÿ±ŸäŸÖ", "ÿ∑Ÿá",
  "ÿßŸÑÿ£ŸÜÿ®Ÿäÿßÿ°", "ÿßŸÑÿ≠ÿ¨", "ÿßŸÑŸÖÿ§ŸÖŸÜŸàŸÜ", "ÿßŸÑŸÜŸàÿ±", "ÿßŸÑŸÅÿ±ŸÇÿßŸÜ",
  "ÿßŸÑÿ¥ÿπÿ±ÿßÿ°", "ÿßŸÑŸÜŸÖŸÑ", "ÿßŸÑŸÇÿµÿµ", "ÿßŸÑÿπŸÜŸÉÿ®Ÿàÿ™", "ÿßŸÑÿ±ŸàŸÖ",
  "ŸÑŸÇŸÖÿßŸÜ", "ÿßŸÑÿ≥ÿ¨ÿØÿ©", "ÿßŸÑÿ£ÿ≠ÿ≤ÿßÿ®", "ÿ≥ÿ®ÿ•", "ŸÅÿßÿ∑ÿ±",
  "Ÿäÿ≥", "ÿßŸÑÿµÿßŸÅÿßÿ™", "ÿµ", "ÿßŸÑÿ≤ŸÖÿ±", "ÿ∫ÿßŸÅÿ±",
  "ŸÅÿµŸÑÿ™", "ÿßŸÑÿ¥Ÿàÿ±Ÿâ", "ÿßŸÑÿ≤ÿÆÿ±ŸÅ", "ÿßŸÑÿØÿÆÿßŸÜ", "ÿßŸÑÿ¨ÿßÿ´Ÿäÿ©",
  "ÿßŸÑÿ£ÿ≠ŸÇÿßŸÅ", "ŸÖÿ≠ŸÖÿØ", "ÿßŸÑŸÅÿ™ÿ≠", "ÿßŸÑÿ≠ÿ¨ÿ±ÿßÿ™", "ŸÇ",
  "ÿßŸÑÿ∞ÿßÿ±Ÿäÿßÿ™", "ÿßŸÑÿ∑Ÿàÿ±", "ÿßŸÑŸÜÿ¨ŸÖ", "ÿßŸÑŸÇŸÖÿ±", "ÿßŸÑÿ±ÿ≠ŸÖŸÜ",
  "ÿßŸÑŸàÿßŸÇÿπÿ©", "ÿßŸÑÿ≠ÿØŸäÿØ", "ÿßŸÑŸÖÿ¨ÿßÿØŸÑÿ©", "ÿßŸÑÿ≠ÿ¥ÿ±", "ÿßŸÑŸÖŸÖÿ™ÿ≠ŸÜÿ©",
  "ÿßŸÑÿµŸÅ", "ÿßŸÑÿ¨ŸÖÿπÿ©", "ÿßŸÑŸÖŸÜÿßŸÅŸÇŸàŸÜ", "ÿßŸÑÿ™ÿ∫ÿßÿ®ŸÜ", "ÿßŸÑÿ∑ŸÑÿßŸÇ",
  "ÿßŸÑÿ™ÿ≠ÿ±ŸäŸÖ", "ÿßŸÑŸÖŸÑŸÉ", "ÿßŸÑŸÇŸÑŸÖ", "ÿßŸÑÿ≠ÿßŸÇÿ©", "ÿßŸÑŸÖÿπÿßÿ±ÿ¨",
  "ŸÜŸàÿ≠", "ÿßŸÑÿ¨ŸÜ", "ÿßŸÑŸÖÿ≤ŸÖŸÑ", "ÿßŸÑŸÖÿØÿ´ÿ±", "ÿßŸÑŸÇŸäÿßŸÖÿ©",
  "ÿßŸÑÿ•ŸÜÿ≥ÿßŸÜ", "ÿßŸÑŸÖÿ±ÿ≥ŸÑÿßÿ™", "ÿßŸÑŸÜÿ®ÿ•", "ÿßŸÑŸÜÿßÿ≤ÿπÿßÿ™", "ÿπÿ®ÿ≥",
  "ÿßŸÑÿ™ŸÉŸàŸäÿ±", "ÿßŸÑÿ•ŸÜŸÅÿ∑ÿßÿ±", "ÿßŸÑŸÖÿ∑ŸÅŸÅŸäŸÜ", "ÿßŸÑÿ•ŸÜÿ¥ŸÇÿßŸÇ", "ÿßŸÑÿ®ÿ±Ÿàÿ¨",
  "ÿßŸÑÿ∑ÿßÿ±ŸÇ", "ÿßŸÑÿ£ÿπŸÑŸâ", "ÿßŸÑÿ∫ÿßÿ¥Ÿäÿ©", "ÿßŸÑŸÅÿ¨ÿ±", "ÿßŸÑÿ®ŸÑÿØ",
  "ÿßŸÑÿ¥ŸÖÿ≥", "ÿßŸÑŸÑŸäŸÑ", "ÿßŸÑÿ∂ÿ≠Ÿâ", "ÿßŸÑÿ¥ÿ±ÿ≠", "ÿßŸÑÿ™ŸäŸÜ",
  "ÿßŸÑÿπŸÑŸÇ", "ÿßŸÑŸÇÿØÿ±", "ÿßŸÑÿ®ŸäŸÜÿ©", "ÿßŸÑÿ≤ŸÑÿ≤ŸÑÿ©", "ÿßŸÑÿπÿßÿØŸäÿßÿ™",
  "ÿßŸÑŸÇÿßÿ±ÿπÿ©", "ÿßŸÑÿ™ŸÉÿßÿ´ÿ±", "ÿßŸÑÿπÿµÿ±", "ÿßŸÑŸáŸÖÿ≤ÿ©", "ÿßŸÑŸÅŸäŸÑ",
  "ŸÇÿ±Ÿäÿ¥", "ÿßŸÑŸÖÿßÿπŸàŸÜ", "ÿßŸÑŸÉŸàÿ´ÿ±", "ÿßŸÑŸÉÿßŸÅÿ±ŸàŸÜ", "ÿßŸÑŸÜÿµÿ±",
  "ÿßŸÑŸÖÿ≥ÿØ", "ÿßŸÑÿ•ÿÆŸÑÿßÿµ", "ÿßŸÑŸÅŸÑŸÇ", "ÿßŸÑŸÜÿßÿ≥"
];

// ========== TRANSLITERATIE FUNCTIE ==========
function arabicToTransliteration(arabicText) {
  let result = arabicText;
  
  // Complete verzen
  const completeVerses = [
    { 
      arabic: 'ÿ®Ÿêÿ≥€°ŸÖŸê Ÿ±ŸÑŸÑŸëŸéŸáŸê Ÿ±ŸÑÿ±ŸëŸéÿ≠€°ŸÖŸéŸÄŸ∞ŸÜŸê Ÿ±ŸÑÿ±ŸëŸéÿ≠ŸêŸäŸÖŸê',
      nl: 'bismi llahi r-rahmaani r-rahiem',
      en: 'bismi llahi r-rahmani r-rahim'
    },
    {
      arabic: 'Ÿ±ŸÑ€°ÿ≠ŸéŸÖ€°ÿØŸè ŸÑŸêŸÑŸëŸéŸáŸê ÿ±Ÿéÿ®ŸëŸê Ÿ±ŸÑ€°ÿπŸéŸÄŸ∞ŸÑŸéŸÖŸêŸäŸÜŸé',
      nl: 'al-hamdu lillahi rabbi l-alameen',
      en: 'al-hamdu lillahi rabbi l-alameen'
    },
    {
      arabic: 'ŸÖŸéŸÄŸ∞ŸÑŸêŸÉŸê ŸäŸéŸà€°ŸÖŸê Ÿ±ŸÑÿØŸëŸêŸäŸÜŸê',
      nl: 'maaliki yawmi d-dien',
      en: 'maaliki yawmi d-din'
    },
    {
      arabic: 'ÿ•ŸêŸäŸëŸéÿßŸÉŸé ŸÜŸéÿπ€°ÿ®ŸèÿØŸè ŸàŸéÿ•ŸêŸäŸëŸéÿßŸÉŸé ŸÜŸéÿ≥€°ÿ™ŸéÿπŸêŸäŸÜŸè',
      nl: 'iyyaaka na-budoe wa iyyaaka nasta-ien',
      en: 'iyyaka na-budu wa iyyaka nasta-in'
    },
    {
      arabic: 'Ÿ±Ÿá€°ÿØŸêŸÜŸéÿß Ÿ±ŸÑÿµŸëŸêÿ±ŸéŸ∞ÿ∑Ÿé Ÿ±ŸÑ€°ŸÖŸèÿ≥€°ÿ™ŸéŸÇŸêŸäŸÖŸé',
      nl: 'ihdina s-siraata l-moestaqiem',
      en: 'ihdina s-sirata l-mustaqim'
    }
  ];
  
  // Check voor complete verzen
  for (let verse of completeVerses) {
    if (result.includes(verse.arabic)) {
      if (currentLanguage === 'nl' && verse.nl) {
        return verse.nl;
      } else if (currentLanguage === 'en' && verse.en) {
        return verse.en;
      }
    }
  }
  
  // Algemene conversie
  result = result
    .replace(/[ÿßÿ£ÿ•ÿ¢ÿ°Ÿ±]/g, 'a')
    .replace(/[ÿ®]/g, 'b')
    .replace(/[ÿ™]/g, 't')
    .replace(/[ÿ´]/g, 'th')
    .replace(/[ÿ¨]/g, 'dj')
    .replace(/[ÿ≠]/g, 'h')
    .replace(/[ÿÆ]/g, 'kh')
    .replace(/[ÿØ]/g, 'd')
    .replace(/[ÿ∞]/g, 'dh')
    .replace(/[ÿ±]/g, 'r')
    .replace(/[ÿ≤]/g, 'z')
    .replace(/[ÿ≥]/g, 's')
    .replace(/[ÿ¥]/g, 'sj')
    .replace(/[ÿµ]/g, 's')
    .replace(/[ÿ∂]/g, 'd')
    .replace(/[ÿ∑]/g, 't')
    .replace(/[ÿ∏]/g, 'z')
    .replace(/[ÿπ]/g, '')
    .replace(/[ÿ∫]/g, 'gh')
    .replace(/[ŸÅ]/g, 'f')
    .replace(/[ŸÇ]/g, 'q')
    .replace(/[ŸÉ]/g, 'k')
    .replace(/[ŸÑ]/g, 'l')
    .replace(/[ŸÖ]/g, 'm')
    .replace(/[ŸÜ]/g, 'n')
    .replace(/[Ÿáÿ©]/g, 'h')
    .replace(/[Ÿà]/g, 'w')
    .replace(/[ŸäŸâ]/g, 'j')
    .replace(/[Ÿé]/g, 'a')
    .replace(/[Ÿê]/g, 'i')
    .replace(/[Ÿè]/g, 'oe')
    .replace(/[Ÿí]/g, '')
    .replace(/[Ÿã]/g, 'an')
    .replace(/[Ÿç]/g, 'in')
    .replace(/[Ÿå]/g, 'oen')
    .replace(/[Ÿë]/g, '')
    .replace(/[Ÿ∞€¶€•]/g, '')
    .replace(/[€°]/g, '')
    .replace(/[ŸÄ]/g, '')
    .replace(/[€ñ€ó€ò€ô€ö€õ€ú€û€©]/g, '')
    .replace(/([btdjsz])Ÿë/g, '$1$1')
    .replace(/ÿßŸÑ/g, 'al')
    .replace(/al-([aoe])/g, 'l-$1')
    .replace(/ŸÖÿ≠ŸÖÿØ/g, 'mohammed')
    .replace(/ÿßŸÑŸÑŸá/g, 'allah')
    .replace(/ÿ±ÿ≥ŸàŸÑ/g, 'rasoel')
    .replace(/ŸÉÿ™ÿßÿ®/g, 'kitab')
    .replace(/ŸÇÿ±ÿ¢ŸÜ/g, 'quran')
    .replace(/[^\w\s\-']/g, '')
    .replace(/\s+/g, ' ')
    .trim();
  
  return result;
}

let currentLanguage = 'arabic';
let currentSurahId = null;

// ========== DARK MODE ==========
document.getElementById("themeBtn").onclick = () => {
  document.documentElement.classList.toggle("dark");
};

// ========== TAAL SELECTOR ==========
document.getElementById("languageSelect").addEventListener('change', (e) => {
  currentLanguage = e.target.value;
  
  document.getElementById('headerTitle').textContent = translations[currentLanguage].headerTitle;
  document.getElementById('backText').textContent = translations[currentLanguage].back;
  document.getElementById('supportText').textContent = translations[currentLanguage].support;
  
  document.documentElement.lang = currentLanguage;
  
  if (currentSurahId) {
    openSurah(currentSurahId);
  } else {
    loadSurahList();
  }
});

// ========== SURAH LIST ==========
function loadSurahList() {
  fetch("https://api.alquran.cloud/v1/surah")
    .then(r => r.json())
    .then(data => {
      const list = document.getElementById("surahList");
      list.innerHTML = '';
      
      data.data.forEach((surah, index) => {
        const card = document.createElement("div");
        card.className = "surah-card bg-white dark:bg-gray-800 rounded shadow p-4 cursor-pointer";

        let title = '';
        let arabicName = '';
        
        if (currentLanguage === 'arabic') {
          title = `${surah.number}. ${arabicSuraNames[index] || surah.name}`;
        } else {
          title = `${surah.number}. ${latinSuraNames[index] || surah.englishName}`;
          arabicName = `<div class="arabic-surah-name">${arabicSuraNames[index] || surah.name}</div>`;
        }

        card.innerHTML = `
          <h3 class="font-bold text-lg">${title}</h3>
          ${arabicName}
          <div class="mt-2 text-xs text-gray-500">${surah.numberOfAyahs} ${translations[currentLanguage].verses}</div>
        `;

        card.onclick = () => openSurah(surah.number);
        list.appendChild(card);
      });
    });
}

// ========== OPEN SURAH ==========
async function openSurah(id) {
  currentSurahId = id;
  
  document.getElementById("surahList").classList.add("hidden");
  document.getElementById("surahPage").classList.remove("hidden");
  
  document.getElementById("surahText").innerHTML = '<p class="text-center">' + translations[currentLanguage].loading + '</p>';

  try {
    const response = await fetch(`https://api.alquran.cloud/v1/surah/${id}`);
    const data = await response.json();
    const s = data.data;
    const index = s.number - 1;

    // Soera informatie
    let title = '';
    let infoText = '';
    
    if (currentLanguage === 'arabic') {
      title = `${s.number}. ${arabicSuraNames[index] || s.name}`;
      infoText = `${s.numberOfAyahs} ${translations[currentLanguage].verses}`;
    } else {
      title = `${s.number}. ${latinSuraNames[index] || s.englishName}`;
      infoText = `${s.numberOfAyahs} ${translations[currentLanguage].verses}`;
    }
    
    document.getElementById("surahTitle").textContent = title;
    document.getElementById("surahInfo").textContent = infoText;
    document.getElementById("surahAudio").src = `https://cdn.islamic.network/quran/audio-surah/128/ar.alafasy/${id}.mp3`;

    const savedAyah = localStorage.getItem(`lastRead-${id}`);
    const lastReadEl = document.getElementById("lastReadInfo");
    lastReadEl.textContent = savedAyah
      ? `${translations[currentLanguage].lastRead} ${savedAyah}`
      : "";

    const surahText = document.getElementById("surahText");
    surahText.innerHTML = "";

    s.ayahs.forEach(a => {
      const d = document.createElement("div");
      d.className = "verse-container";

      if (savedAyah == a.numberInSurah) {
        d.classList.add("last-read");
        setTimeout(() => d.scrollIntoView({ behavior: "smooth" }), 300);
      }

      let displayText = a.text;
      let textClass = 'arabic-text';
      
      if (currentLanguage !== 'arabic') {
        displayText = arabicToTransliteration(a.text);
        textClass = 'transliteration-text';
      }

      d.innerHTML = `
        <div class="${textClass}">${displayText}</div>
        <div class="verse-number">(${translations[currentLanguage].verse} ${a.numberInSurah})</div>
      `;

      d.onclick = () => {
        const key = `lastRead-${id}`;
        const currentLastRead = localStorage.getItem(key);
        
        if (currentLastRead == a.numberInSurah) {
          localStorage.removeItem(key);
        } else {
          localStorage.setItem(key, a.numberInSurah);
        }
        
        openSurah(id);
      };

      surahText.appendChild(d);
    });
    
  } catch (error) {
    document.getElementById("surahText").innerHTML = 
      `<div class="text-red-500">${translations[currentLanguage].error}</div>`;
  }
}

// ========== BACK BUTTON ==========
document.getElementById("backBtn").onclick = () => {
  document.getElementById("surahPage").classList.add("hidden");
  document.getElementById("surahList").classList.remove("hidden");
  currentSurahId = null;
};

// ========== INIT ==========
loadSurahList();
</script>

</body>
</html>
